{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport store from '@/store';\nimport { mapGetters } from 'vuex';\nimport Pagination from \"@/components/Pagination/PaginationBox.vue\";\nexport default {\n  components: {\n    Pagination\n  },\n  name: \"Room\",\n  computed: {\n    ...mapGetters([\"UserInfo\", 'Token', 'UserId'])\n  },\n  data() {\n    return {\n      activeName: \"选座列表\",\n      RoomId: undefined,\n      RoomDetail: null,\n      DateList: [],\n      SeatArrange: null,\n      SelectDate: null\n    };\n  },\n  created() {\n    this.RoomId = this.$route.query.RoomId;\n    this.GetRoomApi();\n    this.GetSevenDaysApi();\n  },\n  methods: {\n    //得到自习室详情接口\n    async GetRoomApi() {\n      let {\n        Data\n      } = await this.$Post(\"/Room/Get\", {\n        Id: this.RoomId\n      });\n      this.RoomDetail = Data;\n    },\n    //得到最近7天\n    async GetSevenDaysApi() {\n      let {\n        Data\n      } = await this.$Post(\"/Seat/GetSevenDays\", {});\n      this.DateList = Data;\n      this.SelectDate = this.DateList[0];\n      this.GetArrange();\n    },\n    //得到选中日期的座位信息 \n    async GetArrange() {\n      let {\n        Data\n      } = await this.$Post(\"/Seat/GetArrange\", {\n        RoomId: this.RoomId,\n        SelectDate: this.SelectDate + \" 00:00:00\"\n      });\n      this.SeatArrange = Data;\n    },\n    //选中日期\n    async DateHandleClick(e) {\n      console.log(e);\n      this.GetArrange();\n    },\n    //返回上一个页面\n    goBack() {\n      this.$router.go(-1);\n    },\n    //去预约\n    async ToAppoint(col, type) {\n      if (col.IsOccupy) {\n        return;\n      }\n      if (!this.Token) {\n        this.$message.warning(\"请先登录后,在操作\");\n        return;\n      }\n      let body = {\n        RoomId: this.RoomId,\n        UserId: this.UserId,\n        SeatId: col.Id,\n        AppointDateType: type,\n        AppointDate: this.SelectDate + \" 00:00:00\"\n      };\n      let {\n        Success\n      } = await this.$Post(\"/AppointRecord/CheckIsAbleAppoint\", body);\n      let tick = new Date().getTime();\n      localStorage.setItem(tick, JSON.stringify(body));\n      if (Success) {\n        this.$router.push({\n          path: \"/Front/ToOrder\",\n          query: {\n            tick: tick\n          }\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["store","mapGetters","Pagination","components","name","computed","data","activeName","RoomId","undefined","RoomDetail","DateList","SeatArrange","SelectDate","created","$route","query","GetRoomApi","GetSevenDaysApi","methods","Data","$Post","Id","GetArrange","DateHandleClick","e","console","log","goBack","$router","go","ToAppoint","col","type","IsOccupy","Token","$message","warning","body","UserId","SeatId","AppointDateType","AppointDate","Success","tick","Date","getTime","localStorage","setItem","JSON","stringify","push","path"],"sources":["src/views/Front/Room.vue"],"sourcesContent":["<template>\r\n    <div v-if=\"RoomDetail\">\r\n        <el-page-header class=\"card margin-top-lg\" @back=\"goBack\" :content=\"RoomDetail.Name\">\r\n        </el-page-header>\r\n        <div class=\" card margin-top-lg margin-bottom-lg\">\r\n            <div>\r\n                <img :src=\"RoomDetail.Cover\" style=\"width: 100%;border-radius: 10px;\">\r\n            </div>\r\n            <div class=\"container\">\r\n                <el-tabs v-model=\"activeName\">\r\n                    <el-tab-pane label=\"详情介绍\" name=\"详情介绍\">\r\n                        <div class=\"content\" v-html=\"RoomDetail.Content\"></div>\r\n                    </el-tab-pane>\r\n                    <el-tab-pane label=\"选座列表\" name=\"选座列表\">\r\n\r\n                        <h4>先选择日期</h4>\r\n                        <el-tabs v-model=\"SelectDate\" @tab-click=\"DateHandleClick\">\r\n                            <el-tab-pane :label=\"item\" :name=\"item\" v-for=\"(item, index) in DateList\"></el-tab-pane>\r\n\r\n                        </el-tabs>\r\n\r\n                        <template v-if=\"SeatArrange\">\r\n                            <h4>上午</h4>\r\n                            <em class=\"tip\">如果有人提前离开了,座位是会被释放的</em>\r\n                            <el-empty v-if=\"SeatArrange.AmSeatDtoList.length == 0\" description=\"暂时没有数据\"></el-empty>\r\n                            <div class=\"seat-list\">\r\n                                <div class=\"seat-row\" v-for=\"(row, rowIndex) in SeatArrange.AmSeatDtoList\">\r\n                                    <div class=\"seat-col\" v-for=\"(col, colIndex) in row\">\r\n                                        <div v-if=\"col.Id\" @click=\"ToAppoint(col, 1)\">\r\n                                            <img v-if=\"col.IsOccupy == false\" :src=\"require('@/assets/seat.png')\">\r\n                                            <img v-else :src=\"require('@/assets/seatcked.png')\">\r\n                                            <div class=\"tit\"><span>{{ col.No }}</span></div>\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                            <h4>下午</h4>\r\n                            <em class=\"tip\">如果有人提前离开了,座位是会被释放的</em>\r\n                            <el-empty v-if=\"SeatArrange.PmSeatDtoList.length == 0\" description=\"暂时没有数据\"></el-empty>\r\n                            <div class=\"seat-list\">\r\n                                <div class=\"seat-row\" v-for=\"(row, rowIndex) in SeatArrange.PmSeatDtoList\">\r\n                                    <div class=\"seat-col\" v-for=\"(col, colIndex) in row\">\r\n                                        <div v-if=\"col.Id\" @click=\"ToAppoint(col, 2)\">\r\n                                            <img v-if=\"col.IsOccupy == false\" :src=\"require('@/assets/seat.png')\">\r\n                                            <img v-else :src=\"require('@/assets/seatcked.png')\">\r\n                                            <div class=\"tit\"><span>{{ col.No }}</span></div>\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                            </div>\r\n                            <h4>夜晚</h4>\r\n                            <em class=\"tip\">如果有人提前离开了,座位是会被释放的</em>\r\n                            <el-empty v-if=\"SeatArrange.NmSeatDtoList.length == 0\" description=\"暂时没有数据\"></el-empty>\r\n                            <div class=\"seat-list\">\r\n                                <div class=\"seat-row\" v-for=\"(row, rowIndex) in SeatArrange.NmSeatDtoList\">\r\n                                    <div class=\"seat-col\" v-for=\"(col, colIndex) in row\">\r\n                                        <div v-if=\"col.Id\" @click=\"ToAppoint(col, 3)\">\r\n                                            <img v-if=\"col.IsOccupy == false\" :src=\"require('@/assets/seat.png')\">\r\n                                            <img v-else :src=\"require('@/assets/seatcked.png')\">\r\n                                            <div class=\"tit\"><span>{{ col.No }}</span></div>\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                            </div>\r\n                        </template>\r\n                    </el-tab-pane>\r\n                    <el-tab-pane label=\"使用评价\" name=\"使用评价\">\r\n                        <Pagination url=\"/AppointRecord/List\" :where=\"{ RoomId: RoomId, AppointStatus: 3 }\">\r\n                            <template v-slot:content=\"{ data }\">\r\n                                <div class=\"comment-list\">\r\n                                    <div class=\"comment-item\" v-for=\"(item, index) in data\" :key=\"index\">\r\n                                        <div>\r\n                                            <img class=\"head\"\r\n                                                :src=\"item.UserDto.ImageUrls ? item.UserDto.ImageUrls : require('@/assets/emptyheadimg.png')\">\r\n                                        </div>\r\n                                        <div>\r\n                                            <div>\r\n                                                <span class=\"name\">{{ item.UserDto.Name }}</span>\r\n                                                <em class=\"seat\">它当时的选座{{ item.SeatDto.No }}</em>\r\n                                            </div>\r\n                                            <div>\r\n                                                <el-rate disabled v-model=\"item.CommentScore\"></el-rate>\r\n                                            </div>\r\n                                            <div class=\"content\">\r\n                                                {{ item.Comment }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                </div>\r\n                            </template>\r\n                        </Pagination>\r\n\r\n\r\n\r\n                    </el-tab-pane>\r\n\r\n                </el-tabs>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport store from '@/store';\r\nimport { mapGetters } from 'vuex';\r\nimport Pagination from \"@/components/Pagination/PaginationBox.vue\"\r\nexport default {\r\n    components: {\r\n        Pagination\r\n    },\r\n    name: \"Room\",\r\n    computed: {\r\n        ...mapGetters([\"UserInfo\", 'Token', 'UserId'])\r\n    },\r\n    data() {\r\n        return {\r\n            activeName: \"选座列表\",\r\n            RoomId: undefined,\r\n            RoomDetail: null,\r\n            DateList: [],\r\n            SeatArrange: null,\r\n            SelectDate: null,\r\n\r\n\r\n        }\r\n    },\r\n    created() {\r\n        this.RoomId = this.$route.query.RoomId\r\n        this.GetRoomApi()\r\n        this.GetSevenDaysApi()\r\n\r\n    },\r\n    methods: {\r\n        //得到自习室详情接口\r\n        async GetRoomApi() {\r\n            let { Data } = await this.$Post(\"/Room/Get\", { Id: this.RoomId })\r\n            this.RoomDetail = Data;\r\n        },\r\n        //得到最近7天\r\n        async GetSevenDaysApi() {\r\n            let { Data } = await this.$Post(\"/Seat/GetSevenDays\", {})\r\n            this.DateList = Data;\r\n            this.SelectDate = this.DateList[0]\r\n            this.GetArrange();\r\n        },\r\n        //得到选中日期的座位信息 \r\n        async GetArrange() {\r\n            let { Data } = await this.$Post(\"/Seat/GetArrange\", { RoomId: this.RoomId, SelectDate: this.SelectDate + \" 00:00:00\" })\r\n            this.SeatArrange = Data;\r\n        },\r\n        //选中日期\r\n        async DateHandleClick(e) {\r\n            console.log(e)\r\n            this.GetArrange();\r\n        },\r\n        //返回上一个页面\r\n        goBack() {\r\n            this.$router.go(-1)\r\n        },\r\n        //去预约\r\n        async ToAppoint(col, type) {\r\n            if (col.IsOccupy) {\r\n                return;\r\n            }\r\n            if (!this.Token) {\r\n                this.$message.warning(\"请先登录后,在操作\");\r\n                return;\r\n            }\r\n            let body = {\r\n                RoomId: this.RoomId,\r\n                UserId: this.UserId,\r\n                SeatId: col.Id,\r\n                AppointDateType: type,\r\n                AppointDate: this.SelectDate + \" 00:00:00\"\r\n            };\r\n\r\n            let { Success } = await this.$Post(\"/AppointRecord/CheckIsAbleAppoint\", body)\r\n\r\n            let tick = new Date().getTime();\r\n            localStorage.setItem(tick, JSON.stringify(body));\r\n\r\n            if (Success) {\r\n                this.$router.push({\r\n                    path: \"/Front/ToOrder\",\r\n                    query: {\r\n                        tick: tick\r\n                    }\r\n                })\r\n            }\r\n\r\n\r\n        },\r\n\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.content {\r\n    font-family: Arial, sans-serif;\r\n    font-size: 14px;\r\n    line-height: 2.5;\r\n    color: #333;\r\n}\r\n\r\n.seat-list {\r\n    margin: 0 auto;\r\n}\r\n\r\n.seat-list .seat-row {\r\n    display: flex;\r\n    margin: 0 auto;\r\n    width: fit-content;\r\n    cursor: pointer;\r\n\r\n}\r\n\r\n.seat-list .seat-row .seat-col {\r\n    margin-top: 20px;\r\n    margin-left: 20px;\r\n    width: 60px;\r\n    height: 70px;\r\n}\r\n\r\n.seat-list .seat-row .seat-col img {\r\n    width: 50px;\r\n    height: 50px;\r\n    pointer-events: none;\r\n}\r\n\r\n.seat-list .seat-row .seat-col .tit {\r\n    font-weight: bold;\r\n}\r\n\r\n\r\n\r\n.comment-list {\r\n    width: 100%;\r\n}\r\n\r\n.comment-list .comment-item {\r\n    display: flex;\r\n    margin-bottom: 15px;\r\n    border-bottom: 1px dashed rgb(129, 127, 127);\r\n\r\n}\r\n\r\n.comment-list .comment-item .head {\r\n    margin-right: 10px;\r\n    width: 40px;\r\n    height: 40px;\r\n    border-radius: 50%;\r\n    overflow: hidden;\r\n}\r\n\r\n.comment-list .comment-item .name {\r\n    font-weight: bolder;\r\n\r\n}\r\n\r\n.comment-list .comment-item .seat {\r\n    font-size: 13px;\r\n    margin-left: 10px;\r\n    color: #333;\r\n\r\n\r\n}\r\n\r\n.tip {\r\n    color: red;\r\n    font-size: 12px;\r\n}\r\n</style>"],"mappings":";AAmHA,OAAAA,KAAA;AACA,SAAAC,UAAA;AACA,OAAAC,UAAA;AACA;EACAC,UAAA;IACAD;EACA;EACAE,IAAA;EACAC,QAAA;IACA,GAAAJ,UAAA;EACA;EACAK,KAAA;IACA;MACAC,UAAA;MACAC,MAAA,EAAAC,SAAA;MACAC,UAAA;MACAC,QAAA;MACAC,WAAA;MACAC,UAAA;IAGA;EACA;EACAC,QAAA;IACA,KAAAN,MAAA,QAAAO,MAAA,CAAAC,KAAA,CAAAR,MAAA;IACA,KAAAS,UAAA;IACA,KAAAC,eAAA;EAEA;EACAC,OAAA;IACA;IACA,MAAAF,WAAA;MACA;QAAAG;MAAA,eAAAC,KAAA;QAAAC,EAAA,OAAAd;MAAA;MACA,KAAAE,UAAA,GAAAU,IAAA;IACA;IACA;IACA,MAAAF,gBAAA;MACA;QAAAE;MAAA,eAAAC,KAAA;MACA,KAAAV,QAAA,GAAAS,IAAA;MACA,KAAAP,UAAA,QAAAF,QAAA;MACA,KAAAY,UAAA;IACA;IACA;IACA,MAAAA,WAAA;MACA;QAAAH;MAAA,eAAAC,KAAA;QAAAb,MAAA,OAAAA,MAAA;QAAAK,UAAA,OAAAA,UAAA;MAAA;MACA,KAAAD,WAAA,GAAAQ,IAAA;IACA;IACA;IACA,MAAAI,gBAAAC,CAAA;MACAC,OAAA,CAAAC,GAAA,CAAAF,CAAA;MACA,KAAAF,UAAA;IACA;IACA;IACAK,OAAA;MACA,KAAAC,OAAA,CAAAC,EAAA;IACA;IACA;IACA,MAAAC,UAAAC,GAAA,EAAAC,IAAA;MACA,IAAAD,GAAA,CAAAE,QAAA;QACA;MACA;MACA,UAAAC,KAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;QACA;MACA;MACA,IAAAC,IAAA;QACA9B,MAAA,OAAAA,MAAA;QACA+B,MAAA,OAAAA,MAAA;QACAC,MAAA,EAAAR,GAAA,CAAAV,EAAA;QACAmB,eAAA,EAAAR,IAAA;QACAS,WAAA,OAAA7B,UAAA;MACA;MAEA;QAAA8B;MAAA,eAAAtB,KAAA,sCAAAiB,IAAA;MAEA,IAAAM,IAAA,OAAAC,IAAA,GAAAC,OAAA;MACAC,YAAA,CAAAC,OAAA,CAAAJ,IAAA,EAAAK,IAAA,CAAAC,SAAA,CAAAZ,IAAA;MAEA,IAAAK,OAAA;QACA,KAAAd,OAAA,CAAAsB,IAAA;UACAC,IAAA;UACApC,KAAA;YACA4B,IAAA,EAAAA;UACA;QACA;MACA;IAGA;EAEA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}